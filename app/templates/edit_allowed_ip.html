{% extends "base.html" %}

{% block title %}Edit Allowed IP - SSH Key Manager{% endblock %}

{% block content %}
<div class="card">
    <div class="card-body">
        <h5 class="card-title">Edit Allowed IP / CIDR / ASN</h5>
        <form method="post" action="/admin/allowed-ips/edit/{{ allowed_ip['id'] }}">

            <div class="mb-3">
                <label>IP / CIDR / ASN:</label>
                <input type="text" name="ip_or_cidr_or_asn" class="form-control" required value="{{ allowed_ip['ip_or_cidr_or_asn'] }}">
            </div>

            <div class="mb-3">
                <label>Type:</label>
                <select name="type" class="form-control" required>
                    <option value="IP" {% if allowed_ip['type'] == 'IP' %}selected{% endif %}>IP</option>
                    <option value="CIDR" {% if allowed_ip['type'] == 'CIDR' %}selected{% endif %}>CIDR</option>
                    <option value="ASN" {% if allowed_ip['type'] == 'ASN' %}selected{% endif %}>ASN</option>
                </select>
            </div>

            <div class="mb-3">
                <label>Context:</label>
                <select name="context" class="form-control" required>
                    <option value="api" {% if allowed_ip['context'] == 'api' %}selected{% endif %}>api</option>
                    <option value="admin" {% if allowed_ip['context'] == 'admin' %}selected{% endif %}>admin</option>
                    <option value="both" {% if allowed_ip['context'] == 'both' %}selected{% endif %}>both</option>
                </select>
            </div>

            <div class="mb-3">
                <label>Description:</label>
                <input type="text" name="description" class="form-control" value="{{ allowed_ip['description'] }}">
            </div>

            <button type="submit" class="btn btn-primary">Save Changes</button>

        </form>
    </div>
</div>

<br><a href="/admin/allowed-ips">‚Üê Back to Allowed IPs</a>

{% endblock %}